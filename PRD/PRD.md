# 小红花 小程序 MVP 版 PRD v1.0

---

## 1. 产品背景与目标

### 1.1 产品背景

许多家长希望通过更轻松、更有趣的方式引导孩子养成好习惯，但传统的“提醒—监督—奖励”方式操作繁琐，孩子参与度低，家长负担重。

“小红花”希望为家庭提供一个轻量、温和、游戏化的习惯奖励系统，让孩子自发参与、家长轻量管理。

### 1.2 核心目标（MVP）
* **帮助孩子建立自我激励机制**，通过可视化奖励（小红花）驱动习惯养成。
* **降低家长管理成本**，任务无需逐条确认，由孩子自主完成。
* **提供简单、高效、柔和的家庭协作机制**（任务、奖励、兑换）。
* **提供可扩展的任务体系**（每天任务、一次性挑战、家务任务）。

### 1.3 目标用户

* **小朋友（5–12 岁）**：主要使用者，负责领取任务、完成任务、兑换奖励。
* **家长**：负责创建任务、管理奖励、查看孩子习惯进展。

---

## 2. 整体功能结构（MVP）

```text
小朋友端
  ├─ 首页（任务列表 + 小红花数）
  ├─ 任务详情（领取 / 完成）
  ├─ 奖励商城（可兑换奖励）

家长端（切换入口）
  ├─ 孩子任务管理（查看已完成 / 本周记录）
  ├─ 创建 / 编辑任务
  ├─ 管理奖励商城
  ├─ 孩子积分调整（纠偏机制）
```

---

## 3. 核心功能说明（MVP）

### 3.1 双视角登录

* 用户进入小程序后，可直接使用微信登录。
* **默认进入小朋友视角**。
* 设置页提供“切换至家长视角”入口（需输入家长密码）。

#### 家长密码设置（首次进入）

* 初次进入需设置 4 位数字密码（默认 0000）。

---

## 4. 小朋友视角（核心体验）

### 首页 UI 草图

> 最终首页应包含底部导航（首页 / 积分商城 / 设置）。此处为任务区域示意。
下图设计草图，可参考其UI风格和页面布局:  
/Users/xila/xiaohonghua/PRD/设计草图.png


### 4.1 首页功能

* 小红花计数器（总积分）
* 今日/可领取任务列表（卡片）
* 底部导航栏（首页 / 积分商城 / 设置）
* 顶部右侧为“设置”入口

### 4.2 任务卡片（支线任务风格）

**卡片内容：**

* 图标（emoji / 插画）
* 标题 + 标签（如“5分钟”）
* 奖励值（+X 小红花）
* 领取按钮（接取任务/我完成啦）

**状态：**

1. 未领取：显示“接取任务”
2. 已领取：显示“我完成啦！”

### 4.3 完成任务逻辑

* 无需家长确认，由孩子自我完成。
* 点击后触发：

  * +X 小红花
  * 小红花飞入动画
  * 任务记录生成

### 4.4 任务记录与家长点赞

* 已完成的任务在首页显示"已完成"标记
* 若家长已点赞，显示"❤️已点赞"标识
* 家长点赞不影响积分，仅作为情感鼓励

### 4.5 奖励商城（小朋友端）

* 展示可兑换的奖励（虚拟 + 实物）
* 展示所需小红花数量
* 支持立即兑换并产生记录


---

## 5. 家长视角

### 5.1 家长首页

* 本周任务完成情况
* 未完成任务列表
* **孩子已完成任务列表（可点赞）**
* 奖励商城管理
* 任务管理
* 积分调整
* 每周积分发放设置

#### 家长点赞功能

* 家长可查看孩子所有已完成任务
* 每条任务记录旁显示"点赞"按钮（未点赞时）或"已点赞❤️"（已点赞时）
* 点赞后记录时间戳，小朋友端同步显示
* **功能定位**：鼓励与"看见"，而非审核与评判
* **设计原则**：点赞不影响积分，仅传递情感支持

### 5.2 任务管理

* 新建任务
* 修改任务
* 删除任务
* 任务类型：每日 / 挑战 / 家务

### 5.3 奖励商城管理

* 新增/修改/删除奖励
* 奖励类型：虚拟 / 实物

### 5.4 积分调整

* 家长可手动增减积分
* 用于孩子误点等纠偏场景

### 5.5 每周积分发放

#### 功能目的

每周自动给予固定积分，作为基础奖励。

#### 配置项

* 每周固定发放积分数
* 发放日（周一～周日）
* 发放时间（默认 09:00）
* 启用/停用

#### 发放规则

* 定时自动发放
* 写入 PointHistory
* 防重复发放

#### Edge Cases

* 修改时间/额度 → 下次发放生效
* 积分上限建议 99,999

---

## 6. 数据模型（MVP）

### **User**

```text
id, openid, role, parentPassword, nickname,
avatarUrl, childId
```

### **Task**

```text
id, type, icon, title, description, reward,
createdByParentId, isActive
```

### **TaskRecord**

```text
id, taskId, childId, status, reward,
receivedAt, completedAt, parentLikedAt
```

### **Reward**

```text
id, title, cost, icon, type, isActive,
createdByParentId
```

### **RewardRecord**

```text
id, rewardId, childId, cost, createdAt
```

### **WeeklyPointConfig**

```text
id, childId, weeklyAmount, dayOfWeek,
time, enabled, updatedAt
```

### **PointHistory**

```text
id, childId, change, reason,
sourceType, sourceId, createdAt
```

### 6.1 数据表结构（详细字段 + 类型 + 索引）

（已完整保留所有字段表格，此处略）

### 6.2 ER 图

```text
Parent(User role=parent)
           │
           ▼
Child(User role=child)
   │   │        │        │
   │   │        │        └── WeeklyPointConfig (1:0..1)
   │   │        │
   │   │        └── PointHistory (1:N)
   │   │
   │   └── TaskRecord (1:N)
   │        ▲
   │        │
   │      Task (1:N)
   │
   └── RewardRecord (1:N)
               ▲
               │
             Reward (1:N)
```

### 6.3 业务约束

* 所有积分变动必须写入 `point_history`
* 任务完成/每周发放均需幂等
* 删除使用 `isActive` 软删除
* 积分 ≥ 0

---

## 7. 动效需求

### 小朋友端

* 小红花飞入积分
* 按钮跳动
* 卡片高亮
* 兑换成功粒子爆炸

### 家长端

* 动效弱化

---

## 8. 非功能性需求

* 首屏 < 1.5s
* 家长密码加密
* 小朋友无编辑权限

---

## 9. MVP 范围

### 必做：任务系统 + 积分 + 商城 + 家长管理

### 可延期：多孩子、PK、AI 识别、虚拟花园、成就系统

---

## 10. UI 规范

本章为完整的 **色板（Color Tokens）/ 组件规范（Component Spec）/ 动画规范（Motion Spec）**，用于指导 UI/UX 与前端开发落地。

---

### 10.1 色板（Color Palette）

**品牌主色（Brand Primary）**

* **小红花红（Primary Red）**：`#FF5A5A`
* **柔粉（Soft Pink）**：`#FFE8E8`

**辅助色（Secondary）**

* **奶油黄（Cream Yellow）**：`#FFF6D9`
* **幼芽绿（Leaf Green）**：`#C8E6C9`
* **天空蓝（Sky Blue）**：`#D7ECFF`

**中性色（Neutral）**

* **主文字黑**：`#333333`
* **次文字灰**：`#666666`
* **浅灰背景**：`#F9F9F9`
* **分隔线灰**：`#EAEAEA`
* **卡片白底**：`#FFFFFF`

**整体视觉基调：** 明亮、柔和、儿童友好、轻治愈系。

---

### 10.2 字体与字号（Typography）

* **字体**：小程序默认字体（San Francisco / MiSans / HarmonyOS Sans）
* **字号体系：**

  * 32px：页面标题（如“小红花”）
  * 24px：模块标题（如“今日任务”）
  * 20px：卡片标题（如“整理房间”）
  * 16px：正文（标签、说明）
  * 14px：辅助文字（次要信息）

---

### 10.3 组件规范（Component Specification）

#### ① 卡片（Card）

* 圆角：`24px`
* 背景：`#FFFFFF`
* 阴影：`0 4px 8px rgba(0,0,0,0.06)`
* 内边距：`16px`
* 图标大小：`48px`
* 卡片间距：`12px`

#### ② 按钮（Button）

* 主按钮颜色：`#FF5A5A`（品牌红）
* 圆角：`16px`
* 字号：`16px`
* 字体颜色：`#FFFFFF`
* 内边距：左右 20px，上下 12px
* 点击态：透明度 0.9 + scale(0.96)

#### ③ 标签（Tag）

* 圆角：`12px`
* 背景色：柔粉 or 幼芽绿
* 字号：`14px`
* 内边距：左右 8px，上下 4px

#### ④ 底部导航（Bottom Tab Bar）

* 图标尺寸：`26px`
* 字号：`12px`
* 激活态颜色：品牌红
* 非激活态颜色：`#999999`

#### ⑤ 小红花计数器

* 图标：`20px`
* 数字字体：`28px`，加粗
* 容器圆角：`14px`
* 背景：`#FFE8E8`

---

### 10.4 动画规范（Motion Specification）

#### ① 小红花飞入积分（核心动效）

* 路径：任务卡片 → 右上角计数器
* 时长：`0.6s`
* 动画曲线：`ease-out`
* 粒子数量：6–10 个花瓣
* 粒子生命：`400ms`

#### ② 按钮点击弹跳

* Keyframe：scale 1 → 0.96 → 1
* 总时长：`120ms`
* 动画曲线：`ease-in-out`

#### ③ 任务完成闪光效果

* 白色渐变条横扫卡片
* 透明度：0 → 60% → 0
* 时长：`300ms`

#### ④ 商城兑换成功粒子爆炸

* 粒子扩散半径：`60px`
* 时长：`500ms`
* 粒子形状：小红花 / 星星

#### 动画整体原则

* **轻盈、柔和、不喧宾夺主**
* 小朋友端动效强，家长端动效弱

---

## 11. 用户流程图

以下补充 **完整且详细的用户流程图（Markdown ASCII 流程图）**，覆盖：

* 小朋友首页主流程
* 小朋友奖励兑换流程
* 家长视角切换流程
* 每周积分发放配置流程

---

### 11.1 小朋友首页流程

```text
进入小程序
      ↓
微信登录
      ↓
进入小朋友首页
      ↓
查看小红花积分
      ↓
查看任务列表
      ↓
┌───────────────┐
│ 点击某任务卡片 │
└───────────────┘
      ↓
[未领取] ———→ 显示“接取任务”按钮
      │                     ↓
      │                 点击接取
      ↓                     ↓
[已领取] ———→ 显示“我完成啦”按钮
      │                     ↓
      │               点击“我完成啦”
      ↓                     ↓
积分 +X，小红花飞入动画
      ↓
任务记录更新
      ↓
返回首页
```

---

### 11.2 小朋友奖励兑换流程

```text
首页
  ↓
点击“积分商城”Tab
  ↓
进入奖励商城
  ↓
浏览奖励列表
  ↓
选择奖励
  ↓
点击“兑换”
  ↓
积分扣减（写入 point_history）
  ↓
展示兑换成功动画（粒子爆炸）
  ↓
进入“兑换记录”或返回商城
```

---

### 11.3 家长视角切换流程

```text
首页 → 点击右上角“设置”
                ↓
        设置页（普通设置项）
                ↓
      点击“切换至家长视角”
                ↓
        输入家长密码（PIN）
                ↓
        验证成功 → 家长首页
                ↓
家长执行：任务管理 / 奖励管理 / 积分调整
                ↓
        点击“退出家长视角”
                ↓
           返回小朋友首页
```

---

### 11.4 每周积分发放配置流程

```text
家长首页
     ↓
点击“每周积分发放设置”
     ↓
进入设置页
     ↓
填写/调整以下内容：
  • 每周积分额度（number）
  • 发放星期（Mon~Sun）
  • 发放时间（时:分）
  • 启用/停用（开关）
     ↓
点击“保存”
     ↓
更新 weekly_point_config
     ↓
下一次定时任务发放积分
     ↓
记录写入 point_history
```

---

### 11.5 家长点赞流程

```text
家长首页
     ↓
查看"孩子已完成任务"列表
     ↓
浏览任务记录（任务名称、完成时间）
     ↓
选择某条任务
     ↓
点击"点赞❤️"按钮
     ↓
更新 task_record.parentLikedAt = 当前时间
     ↓
小朋友端同步显示"❤️已点赞"标识
     ↓
（可选）推送通知给小朋友："爸爸/妈妈为你的'整理房间'点赞啦！"
```

**设计要点：**
* 点赞可撤销（再次点击取消）
* 点赞不影响积分计算
* 仅传递"我看见了你的努力"的情感价值
* 避免使用"审核""确认"等管控性词汇

##
