# 小红花后端 - 环境部署指南

## 一、阿里云MySQL部署

### 方案一：购买阿里云RDS MySQL（推荐生产环境）

1. 登录阿里云控制台
2. 选择 **云数据库RDS** → **创建实例**
3. 配置选择：
   - 数据库类型：MySQL
   - 版本：8.0
   - 系列：基础版（开发测试）/ 高可用版（生产）
   - 规格：根据需求选择（最小1核2GB）
   - 存储：20GB起
   - 地域：选择离用户近的区域

4. 配置安全组：
   - 进入实例详情
   - 数据安全性 → 白名单设置
   - 添加本地开发机IP（开发环境）
   - 添加ECS内网IP（生产环境）

5. 创建数据库账号：
   - 账号管理 → 创建账号
   - 账号名称：`xiaohonghua_admin`
   - 密码：设置强密码
   - 权限：读写权限

### 方案二：ECS自建MySQL（成本较低）

1. 购买阿里云ECS服务器
2. 安装MySQL 8.0：

```bash
# CentOS/AliyunLinux
sudo yum install -y mysql-server
sudo systemctl start mysqld
sudo systemctl enable mysqld

# 获取临时密码
sudo grep 'temporary password' /var/log/mysqld.log

# 修改root密码
mysql -u root -p
ALTER USER 'root'@'localhost' IDENTIFIED BY 'YourStrongPassword123!';
```

3. 配置远程访问：

```bash
# 编辑MySQL配置
sudo vi /etc/my.cnf
# 添加或修改：
bind-address = 0.0.0.0

# 重启MySQL
sudo systemctl restart mysqld

# 创建远程用户
mysql -u root -p
CREATE USER 'xiaohonghua_admin'@'%' IDENTIFIED BY 'YourPassword123!';
GRANT ALL PRIVILEGES ON xiaohonghua.* TO 'xiaohonghua_admin'@'%';
FLUSH PRIVILEGES;
```

4. 配置防火墙：

```bash
# 开放3306端口
sudo firewall-cmd --permanent --add-port=3306/tcp
sudo firewall-cmd --reload
```

5. 阿里云安全组规则：
   - 进入ECS实例 → 安全组
   - 添加入方向规则
   - 端口：3306/3306
   - 授权对象：本地IP或0.0.0.0/0（不推荐生产环境）

## 二、创建数据库

连接到MySQL后执行：

```sql
CREATE DATABASE xiaohonghua DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

## 三、本地开发环境配置

### 3.1 安装JDK 17

**macOS（使用Homebrew）：**
```bash
brew install openjdk@17
# 配置环境变量
echo 'export PATH="/opt/homebrew/opt/openjdk@17/bin:$PATH"' >> ~/.zshrc
source ~/.zshrc

# 验证
java -version
```

**Windows：**
1. 下载Oracle JDK 17或OpenJDK 17
2. 安装并配置JAVA_HOME环境变量
3. 添加到PATH

**Linux：**
```bash
sudo yum install java-17-openjdk-devel
# 或
sudo apt-get install openjdk-17-jdk
```

### 3.2 安装Maven

**macOS：**
```bash
brew install maven
mvn -version
```

**Windows/Linux：**
1. 下载Maven 3.8+
2. 解压到指定目录
3. 配置M2_HOME和PATH环境变量

### 3.3 配置Maven阿里云镜像

编辑 `~/.m2/settings.xml`（如果不存在则创建）：

```xml
<?xml version="1.0" encoding="UTF-8"?>
<settings xmlns="http://maven.apache.org/SETTINGS/1.0.0"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0 
          http://maven.apache.org/xsd/settings-1.0.0.xsd">
    <mirrors>
        <mirror>
            <id>aliyunmaven</id>
            <mirrorOf>*</mirrorOf>
            <name>阿里云公共仓库</name>
            <url>https://maven.aliyun.com/repository/public</url>
        </mirror>
    </mirrors>
</settings>
```

### 3.4 安装MySQL客户端工具

**推荐工具：**
- Navicat Premium（商业软件）
- DataGrip（JetBrains，商业软件）
- MySQL Workbench（免费）
- DBeaver（免费开源）
- 命令行客户端

**macOS安装MySQL客户端：**
```bash
brew install mysql-client
echo 'export PATH="/opt/homebrew/opt/mysql-client/bin:$PATH"' >> ~/.zshrc
source ~/.zshrc
```

## 四、连接信息配置

记录以下信息（后续配置application.yml时使用）：

```yaml
# 数据库连接信息模板
数据库地址: xxx.mysql.rds.aliyuncs.com  # 或 ECS公网IP
端口: 3306
数据库名: xiaohonghua
用户名: xiaohonghua_admin
密码: ********
```

## 五、测试连接

使用命令行测试：

```bash
mysql -h xxx.mysql.rds.aliyuncs.com -P 3306 -u xiaohonghua_admin -p
# 输入密码后执行：
SHOW DATABASES;
USE xiaohonghua;
```

连接成功后，环境准备完成！

## 六、开发工具推荐

- **IDE**: IntelliJ IDEA（推荐）/ Eclipse / VS Code
- **API测试**: Postman / Apifox
- **Git客户端**: SourceTree / GitHub Desktop / 命令行

---

**下一步**: 创建Spring Boot项目

