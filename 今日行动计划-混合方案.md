# 今日行动计划 - 混合方案

**创建时间：** 2025-12-23  
**目标：** 今天上线 + 同时准备域名备案

---

## 🎯 双线并行策略

### **线路A：云函数快速上线**（今天完成）
✅ 无需域名，今天就能提交审核

### **线路B：域名备案**（今天开始，20天后完成）
✅ 为未来升级到云托管做准备

---

## 📋 今天的任务清单

### 🔴 **优先级1：云函数迁移**（预计3-4小时）

#### **任务1：开通云开发**（10分钟）

**操作步骤：**
1. 打开微信开发者工具
2. 打开小红花项目
3. 点击顶部工具栏"云开发"按钮
4. 点击"开通云开发"
5. 环境名称：`xiaohonghua-prod`
6. 点击确定

**完成标志：** 获得环境ID（如：`xiaohonghua-7gxxx`）

---

#### **任务2：创建云数据库集合**（20分钟）

**操作步骤：**
1. 在云开发控制台，点击"数据库"
2. 创建以下集合：
   - `users` - 用户信息
   - `tasks` - 任务列表
   - `rewards` - 奖品列表
   - `task_records` - 任务记录
   - `reward_records` - 兑换记录
   - `point_history` - 积分历史
   - `weekly_configs` - 周积分配置

**完成标志：** 7个集合创建成功

---

#### **任务3：创建云函数**（2小时）

**我会为您准备所有云函数代码！**

需要创建的云函数：
1. ✅ `login` - 登录
2. ✅ `getTasks` - 获取任务
3. ✅ `receiveTask` - 领取任务
4. ✅ `completeTask` - 完成任务
5. ✅ `getTaskRecords` - 任务记录
6. ✅ `getCurrentPoints` - 当前积分
7. ✅ `getPointHistory` - 积分历史
8. ✅ `getRewards` - 奖品列表
9. ✅ `exchangeReward` - 兑换奖品
10. ✅ `createTask` - 创建任务（家长）
11. ✅ `updateTask` - 更新任务（家长）
12. ✅ `deleteTask` - 删除任务（家长）
13. ✅ `createReward` - 创建奖品（家长）
14. ✅ `updateReward` - 更新奖品（家长）
15. ✅ `deleteReward` - 删除奖品（家长）
16. ✅ `adjustPoints` - 调整积分（家长）

**操作步骤：**
1. 我会为您准备每个云函数的完整代码
2. 您在开发者工具中右键 `cloudfunctions` 目录
3. 选择"新建 Node.js 云函数"
4. 输入函数名
5. 复制我提供的代码
6. 右键函数 → 上传并部署

---

#### **任务4：修改小程序代码**（1小时）

**需要修改的文件：**

1. `app.js` - 初始化云开发
2. `utils/cloudApi.js` - 创建云函数调用封装（新建）
3. `pages/index/index.js` - 任务页
4. `pages/rewards/rewards.js` - 奖品页
5. `pages/wishes/wishes.js` - 许愿瓶页
6. `pages/parent/` 下的家长端页面

**我会提供所有需要修改的代码！**

---

#### **任务5：测试验证**（30分钟）

**测试清单：**
- [ ] 登录功能
- [ ] 查看任务列表
- [ ] 领取任务
- [ ] 完成任务
- [ ] 查看积分变化
- [ ] 查看奖品列表
- [ ] 兑换奖品
- [ ] 家长端创建任务
- [ ] 家长端管理奖品

---

### 🟡 **优先级2：域名备案**（1小时提交）

#### **任务1：准备资料**（30分钟）

**需要准备：**
- [ ] 身份证正反面照片（清晰）
- [ ] 个人半身照（白色背景）
- [ ] 常用手机号（保持畅通）
- [ ] 常用邮箱

---

#### **任务2：提交备案申请**（30分钟）

**操作步骤：**
1. 访问：https://beian.aliyun.com/
2. 登录阿里云账号
3. 点击"开始备案"
4. 选择"首次备案"
5. 填写个人信息
6. 上传资料
7. 申请备案服务号
8. 提交初审

**详细指南：** 参考《阿里云域名备案指南.md》

---

## 📊 时间安排建议

### **上午（9:00-12:00）**
- ✅ 开通云开发
- ✅ 创建数据库集合
- ✅ 开始创建云函数

### **中午（12:00-13:00）**
- 休息

### **下午（13:00-17:00）**
- ✅ 完成所有云函数
- ✅ 修改小程序代码
- ✅ 测试验证

### **晚上（19:00-20:00）**
- ✅ 提交域名备案
- ✅ 准备提交小程序审核

---

## ✅ 完成标准

### **今天完成（云函数方案）：**
- [x] 云开发已开通
- [x] 所有云函数已部署
- [x] 小程序代码已修改
- [x] 本地测试通过
- [x] 真机测试通过
- [x] **可以提交小程序审核** ✨

### **今天开始（域名备案）：**
- [x] 备案资料已准备
- [x] 备案申请已提交
- [x] 等待阿里云初审

---

## 🎯 后续时间线

| 日期 | 云函数方案 | 域名备案 |
|-----|-----------|---------|
| **今天** | ✅ 上线 | ✅ 提交申请 |
| **明天** | ✅ 提交审核 | ⏳ 阿里云初审 |
| **第3天** | ✅ 用户使用 | ⏳ 工信部核验 |
| **第4-15天** | ✅ 正常运营 | ⏳ 管局审核 |
| **第16天** | ✅ 稳定运行 | ✅ 备案通过！ |
| **第17天** | 准备切换 | ✅ 绑定域名 |
| **第18天** | ✅ 切换云托管 | ✅ 完成！ |

---

## 📞 需要帮助

### **我会帮您：**

1. ✅ 提供所有云函数完整代码
2. ✅ 提供小程序代码修改方案
3. ✅ 解答所有技术问题
4. ✅ 协助测试验证

### **您需要做：**

1. ✅ 开通云开发（点几个按钮）
2. ✅ 创建云函数（复制粘贴代码）
3. ✅ 修改小程序文件（我告诉您改哪里）
4. ✅ 测试功能
5. ✅ 提交备案（准备资料+填表）

---

## 🚀 立即开始

### **第一步：开通云开发**

1. 打开微信开发者工具
2. 打开小红花项目
3. 点击"云开发"按钮
4. 开通环境

**开通成功后，把环境ID发给我！**

格式：`xiaohonghua-7gxxx`

---

## 📚 参考文档

| 文档 | 用途 |
|-----|------|
| 《微信云开发快速迁移指南.md》 | 云函数迁移详细步骤 |
| 《阿里云域名备案指南.md》 | 域名备案详细流程 |
| 《阿里云域名配置指南.md》 | 备案后的域名配置 |

---

**准备好了吗？让我们开始吧！** 🎉

**第一步：打开微信开发者工具，点击"云开发"！** 🚀

