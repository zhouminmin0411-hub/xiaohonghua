<!--å®¶é•¿é¦–é¡µ-->
<view class="container">
  <!-- å¤´éƒ¨ç»Ÿè®¡ -->
  <view class="header">
    <view class="stats-card">
      <view class="stat-item">
        <text class="stat-label">æœ¬å‘¨å®Œæˆ</text>
        <text class="stat-value">{{weeklyCompleted}}</text>
        <text class="stat-unit">ä¸ªä»»åŠ¡</text>
      </view>
      <view class="divider"></view>
      <view class="stat-item">
        <text class="stat-label">å½“å‰ç§¯åˆ†</text>
        <text class="stat-value">{{currentPoints}}</text>
        <text class="stat-unit">å°çº¢èŠ±</text>
      </view>
    </view>
  </view>

  <!-- åŠŸèƒ½å…¥å£ -->
  <view class="function-section">
    <view class="section-title">ç®¡ç†åŠŸèƒ½</view>
    <view class="function-grid">
      <view class="function-item" bind:tap="onNavigateTo" data-url="/pages/parent-tasks/parent-tasks">
        <view class="function-icon">ğŸ“‹</view>
        <view class="function-name">ä»»åŠ¡ç®¡ç†</view>
      </view>
      <view class="function-item" bind:tap="onNavigateTo" data-url="/pages/parent-rewards/parent-rewards">
        <view class="function-icon">ğŸ</view>
        <view class="function-name">å¥–åŠ±ç®¡ç†</view>
      </view>
      <view class="function-item" bind:tap="onShowAdjustDialog">
        <view class="function-icon">âš–ï¸</view>
        <view class="function-name">ç§¯åˆ†è°ƒæ•´</view>
      </view>
      <view class="function-item" bind:tap="onNavigateTo" data-url="/pages/parent-config/parent-config">
        <view class="function-icon">âš™ï¸</view>
        <view class="function-name">æ¯å‘¨é…ç½®</view>
      </view>
    </view>
  </view>

  <!-- æœ€è¿‘å®Œæˆçš„ä»»åŠ¡ -->
  <view class="records-section">
    <view class="section-title">å­©å­æœ€è¿‘å®Œæˆçš„ä»»åŠ¡</view>

    <view wx:if="{{records.length === 0}}" class="empty-state">
      <text class="empty-icon">ğŸ“</text>
      <text class="empty-text">æš‚æ— è®°å½•</text>
    </view>

    <view wx:else class="record-list">
      <view 
        wx:for="{{records}}" 
        wx:key="id"
        class="record-card"
      >
        <view class="record-icon">{{item.taskIcon}}</view>
        <view class="record-info">
          <view class="record-title">{{item.taskTitle}}</view>
          <view class="record-time">{{item.completedAt}}</view>
        </view>
        <view class="record-reward">+{{item.reward}}</view>
        <view class="record-action">
          <van-button
            wx:if="{{!item.parentLikedAt}}"
            type="primary"
            size="mini"
            round
            icon="like-o"
            bind:tap="onLikeTask"
            data-id="{{item.id}}"
          >
            ç‚¹èµ
          </van-button>
          <view wx:else class="liked-tag">
            <text>â¤ï¸ å·²ç‚¹èµ</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- ç§¯åˆ†è°ƒæ•´å¯¹è¯æ¡† -->
  <van-dialog
    use-slot
    title="ç§¯åˆ†è°ƒæ•´"
    show="{{ showAdjustDialog }}"
    show-cancel-button
    confirm-button-text="ç¡®å®š"
    cancel-button-text="å–æ¶ˆ"
    bind:close="onAdjustDialogClose"
    bind:confirm="onConfirmAdjust"
  >
    <view class="adjust-dialog-content">
      <van-field
        value="{{ adjustAmount }}"
        type="number"
        label="è°ƒæ•´æ•°å€¼"
        placeholder="è¾“å…¥æ­£æ•°å¢åŠ ï¼Œè´Ÿæ•°å‡å°‘"
        bind:change="onAdjustAmountChange"
      />
      <van-field
        value="{{ adjustReason }}"
        label="è°ƒæ•´åŸå› "
        placeholder="ä¾‹å¦‚ï¼šå¥–åŠ±è¡¨ç°ä¼˜ç§€"
        bind:change="onAdjustReasonChange"
      />
    </view>
  </van-dialog>

  <!-- Toast -->
  <van-toast id="van-toast" />
</view>

