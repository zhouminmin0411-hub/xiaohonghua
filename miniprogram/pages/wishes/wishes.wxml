<view class="page-container">
  <!-- é¡¶éƒ¨åŒºåŸŸï¼šå¤´åƒ & é—®å€™ -->
  <!-- é¡¶éƒ¨åŒºåŸŸï¼šå¤´åƒ & é—®å€™ -->
  <view class="header">
    <view class="header-content">
      <!-- Avatar Section -->
      <view class="avatar-container" bind:tap="onOpenSettings">
        <image class="avatar-img" src="{{userInfo.avatarUrl}}" mode="aspectFill" wx:if="{{userInfo.avatarUrl}}"/>
        <view class="default-avatar" wx:else>
          <text class="default-avatar-face">ğŸ™‚</text>
        </view>
      </view>
      
      <!-- Greeting Bubble -->
      <view class="greeting-bubble">
        <view class="greeting-text">ä½ å¥½ï¼Œ{{userInfo.nickname || 'å°æœ‹å‹'}}ï¼</view>
        <view class="greeting-sub">ä»Šå¤©ä¹Ÿè¦åŠ æ²¹å“¦~</view>
      </view>
    </view>
  </view>
  <!-- è®¸æ„¿ç“¶å±•ç¤ºåŒº (Hero Section) -->
  <view class="jar-section">
    <view class="jar-container">
      <image class="jar-image" src="{{jarImage}}" mode="aspectFit" />
      
      <!-- é£˜è½èŠ±ç“£åŠ¨ç”» -->
      <view class="petal-container">
        <view 
          wx:for="{{petalCloud}}" 
          wx:key="index"
          class="petal petal-float"
          style="--start-x: {{item.startX}}rpx; --start-y: {{item.startY}}rpx; --h-drift: {{item.horizontalDrift}}rpx; --v-drift: {{item.verticalDrift}}rpx; --duration: {{item.duration}}s; --delay: {{item.delay}}s; --scale: {{item.scale}}; --rotation: {{item.rotation}}deg;"
        >
          <image src="/assets/flower1.png" class="petal-img" mode="aspectFit" />
        </view>
      </view>
    </view>
    
    <view class="jar-info">
      <view class="points-badge">
        <image src="/assets/flower1.png" class="badge-icon" mode="aspectFit" />
        <text class="badge-text">ä½ å·²ç»æ‹¥æœ‰ {{currentPoints}} æœµå°çº¢èŠ±å•¦</text>
      </view>
      <view class="jar-tips">ç»§ç»­æ”¶é›†å°çº¢èŠ±ï¼Œè£…æ»¡è®¸æ„¿ç“¶å§ï¼</view>
    </view>
  </view>

  <!-- æ”¶æ”¯è®°å½•åˆ—è¡¨ -->
  <view class="history-section">
    <view class="section-header">
      <text class="section-title">å°çº¢èŠ±è®°å½•</text>
    </view>

    <view wx:if="{{history.length === 0}}" class="empty-state">
      <text class="empty-icon">ğŸ“</text>
      <text class="empty-text">è¿˜æ²¡æœ‰è®°å½•å“¦</text>
    </view>

    <view wx:else class="history-list">
      <view wx:for="{{history}}" wx:key="id" class="history-item {{item.isIncome ? 'item-income' : 'item-expense'}}">
        <view class="history-left">
          <view class="history-icon-wrapper">
            <text class="history-icon">{{item.isIncome ? 'âœ¨' : 'ğŸ'}}</text>
          </view>
          <view class="history-info">
            <view class="history-title">{{item.reason || (item.isIncome ? 'å®Œæˆä»»åŠ¡' : 'å…‘æ¢å¥–åŠ±')}}</view>
            <view class="history-time">{{item.formattedDate}}</view>
          </view>
        </view>
        <view class="history-right {{item.isIncome ? 'income' : 'expense'}}">
          {{item.isIncome ? '+' : ''}}{{item.change}}
        </view>
      </view>
    </view>
  </view>
</view>
