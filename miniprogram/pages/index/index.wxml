<!-- å°æœ‹å‹é¦–é¡µ Â· ç»˜æœ¬é£ Refined -->
<view class="page-container">
  <!-- é¡¶éƒ¨åŒºåŸŸï¼šå¤´åƒ & é—®å€™ -->
  <view class="header">
    <view class="header-left">
      <view class="avatar" bind:tap="onOpenSettings">
        <text class="avatar-text">ğŸ™‚</text>
      </view>
      <view class="greeting">
        <text class="greeting-text">{{greeting}}</text>
      </view>
    </view>
    <view class="header-right">
      <view class="flower-counter">
        <text class="flower-counter-icon">ğŸŒ¸</text>
        <text class="flower-counter-number">{{currentPoints}}</text>
      </view>
    </view>
  </view>



  <!-- ä»»åŠ¡åˆ—è¡¨åŒºåŸŸ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">ä»Šæ—¥ä»»åŠ¡</text>
      <text class="section-subtitle">å®Œæˆå°±èƒ½å¾—åˆ°å°çº¢èŠ±</text>
    </view>
    
    <view wx:if="{{tasks.length === 0}}" class="empty-state">
      <text class="empty-icon">ğŸ“‹</text>
      <text class="empty-text">æš‚æ— ä»»åŠ¡ï¼Œç­‰ä½ æ¥æ·»åŠ å“¦</text>
    </view>
    
    <view wx:else class="task-list">
      <view 
        wx:for="{{tasks}}" 
        wx:key="id" 
        class="task-card {{item.status === 'completed' ? 'task-completed' : ''}}"
      >
        <!-- å·¦ä¾§å›¾æ ‡ -->
        <view class="task-icon-wrapper">
          <view class="task-icon">{{item.icon || 'ğŸ¯'}}</view>
        </view>

        <!-- ä¸­é—´ä¿¡æ¯ -->
        <view class="task-info">
          <view class="task-title">{{item.title}}</view>
          <view class="task-reward">+{{item.reward}} å°çº¢èŠ±</view>
        </view>

        <!-- å³ä¾§æŒ‰é’® -->
        <view class="task-action">
          <view 
            wx:if="{{item.status === 'available'}}"
            class="action-btn primary-btn"
            bind:tap="onReceiveTask"
            data-id="{{item.id}}"
            id="task-btn-{{item.id}}"
          >
            æ¥å–
          </view>
          <view 
            wx:elif="{{item.status === 'received'}}"
            class="action-btn primary-btn"
            bind:tap="onCompleteTask"
            data-id="{{item.id}}"
            data-record-id="{{item.recordId}}"
            data-reward="{{item.reward}}"
            data-title="{{item.title}}"
            id="task-btn-{{item.id}}"
          >
            æˆ‘åšå®Œå•¦
          </view>
          <view wx:else class="status-text">
            <text>å·²å®Œæˆ</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- å°çº¢èŠ±é£å…¥åŠ¨ç”» -->
  <view 
    wx:if="{{showFlowerAnimation}}" 
    class="flower-animation"
    style="left: {{flowerX}}px; top: {{flowerY}}px;"
    animation="{{flowerAnimationData}}"
  >
    ğŸŒ¸
  </view>

  <van-toast id="van-toast" />
</view>
